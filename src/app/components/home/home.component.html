<div class="container mx-auto p-4">
  <div class="flex justify-between items-center mb-6">
    <h1 class="text-3xl font-bold text-blue-600">CompTIA A+ Quiz Prep</h1>
    <div *ngIf="authService.user$ | async as user" class="flex items-center gap-3">
        <span class="text-sm font-medium">{{ user.phoneNumber }}</span>
        <button (click)="authService.signOut()" class="text-sm text-red-500 hover:underline">Sign out</button>
    </div>
  </div>

  <div *ngIf="loading" class="text-center p-8">
    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"></div>
    <p class="text-xl text-gray-600">Loading quizzes...</p>
  </div>

  <div *ngIf="error" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4" role="alert">
    <p>{{ error }}</p>
    <p class="text-sm mt-2">Make sure you are running the app correctly.</p>
  </div>
  
  <div class="grid gap-4 md:grid-cols-2 lg:grid-cols-3" *ngIf="!error">
    <div class="col-span-full mb-4">
       <div class="flex items-center justify-center bg-blue-50 p-4 rounded-lg">
        <label class="flex items-center space-x-3 cursor-pointer">
          <input type="checkbox" [(ngModel)]="showImmediateFeedback" class="form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500">
          <span class="text-gray-700 font-medium select-none">Show immediate feedback after each answer</span>
        </label>
       </div>
    </div>

    <!-- All Questions Option -->
    <div class="bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow border-l-4 border-blue-500">
      <h2 class="text-xl font-semibold mb-2">Full Practice</h2>
      <p class="text-gray-600 mb-4">Random questions from all chapters.</p>
      <button (click)="startQuiz()" 
              class="w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 transition-colors">
        Start Random Quiz
      </button>
    </div>

    <!-- Chapter List -->
    <ng-container *ngIf="chapters$ | async as chapters">
      <div *ngFor="let chapter of chapters" 
           class="bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow border-l-4 border-green-500">
        <h2 class="text-xl font-semibold mb-2">Chapter {{ chapter }}</h2>
        <p class="text-gray-600 mb-4">Focus on specific topics.</p>
        <button (click)="startQuiz(chapter)" 
                class="w-full bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700 transition-colors">
          Start Chapter Quiz
        </button>
      </div>
      
      <div *ngIf="!loading && chapters.length === 0" class="col-span-full text-center p-4 bg-yellow-50 rounded">
        <p class="text-yellow-700">No chapters found. Please check data source.</p>
      </div>
    </ng-container>
  </div>
</div>
